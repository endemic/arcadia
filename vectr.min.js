(function(t){if(typeof t.Vectr==="undefined"){t.Vectr={}}Vectr.Button=function(t,e,i,s,n,o){this.label=new Vectr.Label(t,e,i,n,o,"center");this.position={x:n,y:o};this.backgroundColor=s;this.height=parseInt(e.split(" ").shift(),10);this.active=true;this.solid=true;this.padding=10;this.onPointEnd=this.onPointEnd.bind(this);Vectr.instance.element.addEventListener("mouseup",this.onPointEnd,false);Vectr.instance.element.addEventListener("touchend",this.onPointEnd,false)};Vectr.Button.prototype.draw=function(t){if(this.active===false){return}this.width=this.label.width(t);t.save();t.translate(this.position.x,this.position.y);if(this.solid===true){t.fillStyle=this.backgroundColor;t.fillRect(-this.width/2-this.padding/2,-this.height/2-this.padding,this.width+this.padding,this.height+this.padding)}else{t.strokeStyle=this.backgroundColor;t.strokeRect(-this.width/2-this.padding/2,-this.height/2-this.padding/2,this.width+this.padding,this.height+this.padding)}t.restore();this.label.draw(t)};Vectr.Button.prototype.onPointEnd=function(t){if(this.active!==true||typeof this.onUp!=="function"){return}Vectr.getPoints(t);if(t.type.indexOf("mouse")!==-1){if(this.containsPoint(Vectr.instance.points[0].x,Vectr.instance.points[0].y)){this.onUp()}}else{var e=Vectr.instance.points.length;while(e--){if(this.containsPoint(Vectr.instance.points[e].x,Vectr.instance.points[e].y)){this.onUp();break}}}};Vectr.Button.prototype.containsPoint=function(t,e){return t<this.position.x+this.width/2+this.padding/2&&t>this.position.x-this.width/2-this.padding/2&&e<this.position.y+this.height/2&&e>this.position.y-this.height/2-this.padding};Vectr.Button.prototype.destroy=function(){var t;for(t in this){if(this.hasOwnProperty(t)){delete this[t]}}Vectr.instance.element.removeEventListener("mouseup",this.onPointEnd,false);Vectr.instance.element.removeEventListener("touchend",this.onPointEnd,false)};Vectr.Button.prototype.update=function(t){}})(window);(function(t){if(typeof t.Vectr==="undefined"){t.Vectr={}}Vectr.Emitter=function(t,e,i,s){var n;this.particles=new Vectr.Pool;while(t--){n=new Vectr.Shape(0,0,e,i,s);n.active=false;this.particles.add(n)}};Vectr.Emitter.prototype.start=function(t,e){this.particles.activateAll();this.active=true;var i,s=this.particles.length;while(s--){this.particles.at(s).position.x=t;this.particles.at(s).position.y=e;i=Math.random()*2*Math.PI;this.particles.at(s).velocity.x=Math.cos(i);this.particles.at(s).velocity.y=Math.sin(i);this.particles.at(s).speed=Math.random()*200;this.particles.at(s).color.alpha=1}this.timer=0};Vectr.Emitter.prototype.draw=function(t){var e=this.particles.length;while(e--){this.particles.at(e).draw(t)}};Vectr.Emitter.prototype.update=function(t){this.timer+=t;var e=this.particles.length;if(e===0){this.active=false}while(e--){this.particles.at(e).update(t);this.particles.at(e).color.alpha-=.03;if(this.particles.at(e).color.alpha<=0){this.particles.deactivate(e)}}}})(window);(function(t){if(typeof t.requestAnimationFrame==="undefined"){t.requestAnimationFrame=t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame}if(typeof t.cancelAnimationFrame==="undefined"){t.cancelAnimationFrame=t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||t.msCancelAnimationFrame}var e={VERSION:"0.1",Game:function(i,s,n){if(typeof i==="undefined"){i=320}if(typeof s==="undefined"){s=480}e.WIDTH=i;e.HEIGHT=s;e.SCALE=1;e.OFFSET={x:0,y:0};e.instance=this;this.element=document.createElement("div");this.element.setAttribute("id","vectr");this.canvas=document.createElement("canvas");this.canvas.setAttribute("width",i);this.canvas.setAttribute("height",s);this.context=this.canvas.getContext("2d");this.onResize();this.element.appendChild(this.canvas);document.body.appendChild(this.element);this.onResize=this.onResize.bind(this);this.onPointStart=this.onPointStart.bind(this);this.onPointMove=this.onPointMove.bind(this);this.onPointEnd=this.onPointEnd.bind(this);this.onKeyDown=this.onKeyDown.bind(this);this.onKeyUp=this.onKeyUp.bind(this);t.addEventListener("resize",this.onResize,false);document.addEventListener("keydown",this.onKeyDown,false);document.addEventListener("keyup",this.onKeyUp,false);this.element.addEventListener("mousedown",this.onPointStart,false);this.element.addEventListener("mouseup",this.onPointEnd,false);this.element.addEventListener("touchstart",this.onPointStart,false);this.element.addEventListener("touchmove",this.onPointMove,false);this.element.addEventListener("touchend",this.onPointEnd,false);this.input={left:false,up:false,right:false,down:false,w:false,a:false,s:false,d:false,enter:false,escape:false,space:false,control:false,z:false,x:false};this.points=[];this.active=new n}};e.Game.prototype.onPointStart=function(t){e.getPoints(t);if(t.type.indexOf("mouse")!==-1){this.element.addEventListener("mousemove",this.onPointMove,false)}if(typeof this.active.onPointStart==="function"){this.active.onPointStart(this.points)}};e.Game.prototype.onPointMove=function(t){e.getPoints(t);if(typeof this.active.onPointMove==="function"){this.active.onPointMove(this.points)}};e.Game.prototype.onPointEnd=function(t){e.getPoints(t);if(t.type.indexOf("mouse")!==-1){this.element.removeEventListener("mousemove",this.onPointMove,false)}if(typeof this.active.onPointEnd==="function"){this.active.onPointEnd(this.points)}};e.Game.prototype.onKeyDown=function(t){var e;switch(t.keyCode){case 37:e="left";break;case 38:e="up";break;case 39:e="right";break;case 40:e="down";break;case 87:e="w";break;case 65:e="a";break;case 83:e="s";break;case 68:e="d";break;case 13:e="enter";break;case 27:e="escape";break;case 32:e="space";break;case 17:e="control";break;case 90:e="z";break;case 88:e="x";break;default:break}if(this.input[e]===true){return}this.input[e]=true;if(typeof this.active.onKeyDown==="function"){this.active.onKeyDown(e)}};e.Game.prototype.onKeyUp=function(t){var e;switch(t.keyCode){case 37:e="left";break;case 38:e="up";break;case 39:e="right";break;case 40:e="down";break;case 87:e="w";break;case 65:e="a";break;case 83:e="s";break;case 68:e="d";break;case 13:e="enter";break;case 27:e="escape";break;case 32:e="space";break;case 17:e="control";break;case 90:e="z";break;case 88:e="x";break;default:break}this.input[e]=false;if(typeof this.active.onKeyUp==="function"){this.active.onKeyUp(e)}};e.Game.prototype.start=function(){var e,i,s;i=this;if(typeof t.performance!=="undefined"){e=t.performance.now()}else{e=Date.now()}s=function(n){var o=n-e;e=n;i.update(o/1e3);i.updateId=t.requestAnimationFrame(s)};this.updateId=t.requestAnimationFrame(s)};e.Game.prototype.stop=function(){t.cancelAnimationFrame(this.updateId)};e.Game.prototype.update=function(t){this.active.draw(this.context);this.active.update(t)};e.Game.prototype.onResize=function(i){var s,n,o,a,h;s=t.innerWidth;n=t.innerHeight;if(s>n){a="landscape";o=e.WIDTH/e.HEIGHT}else{a="portrait";o=e.HEIGHT/e.WIDTH}if(a==="landscape"){if(s/o>n){s=n*o;h="0 "+(t.innerWidth-s)/2+"px"}else if(s/o<n){n=s/o;h=(t.innerHeight-n)/2+"px 0"}}else if(a==="portrait"){if(n/o>s){n=s*o;h=(t.innerHeight-n)/2+"px 0"}else if(n/o<s){s=n/o;h="0 "+(t.innerWidth-s)/2+"px"}}e.SCALE=n/e.HEIGHT;e.OFFSET.x=(t.innerWidth-s)/2;e.OFFSET.y=(t.innerHeight-n)/2;this.element.setAttribute("style","position: relative; width: "+s+"px; height: "+n+"px; margin: "+h);this.canvas.setAttribute("style","position: absolute; left: 0; top: 0; width: "+s+"px; height: "+n+"px;")};e.changeLayer=function(t){if(typeof t!=="function"){throw"Trying to change to an invalid layer."}e.instance.active=new t};e.getPoints=function(t){var i=0,s;e.instance.points.length=0;if(t.type.indexOf("mouse")!==-1){e.instance.points.push({x:(t.pageX-e.OFFSET.x)/e.SCALE,y:(t.pageY-e.OFFSET.y)/e.SCALE})}else{s=t.touches.length;while(i<s){e.instance.points.push({x:(t.touches[i].pageX-e.OFFSET.x)/e.SCALE,y:(t.touches[i].pageY-e.OFFSET.y)/e.SCALE});i+=1}}};t.Vectr=e})(window);(function(t){if(typeof t.Vectr==="undefined"){t.Vectr={}}Vectr.Label=function(t,e,i,s,n,o){var a;this.text=t;this.font={size:"20px",family:"monospaced"};if(typeof e==="string"){a=e.split(" ");if(a.length===2){this.font.size=a[0];this.font.family=a[1]}}this.color={red:255,green:255,blue:255,alpha:1};if(typeof i==="string"){a=i.split(",");if(a.length===4){this.color.red=parseInt(a[0].replace("rgba(",""),10);this.color.green=parseInt(a[1],10);this.color.blue=parseInt(a[2],10);this.color.alpha=parseFloat(a[3].replace(")",""),10)}}this.alignment="center";if(typeof o==="string"){this.alignment=o}this.scale=1;this.rotation=0;this.position={x:s,y:n};this.active=true;this.solid=true};Vectr.Label.prototype.draw=function(t){if(this.active===false){return}t.save();t.font=this.font.size+" "+this.font.family;t.textAlign=this.alignment;t.translate(this.position.x,this.position.y+parseInt(this.font.size,10)/3);if(this.scale!==1){t.scale(this.scale,this.scale)}if(this.rotation!==0&&this.rotation!==360){t.rotate(this.rotation)}if(this.solid===true){t.fillStyle="rgba("+this.color.red+", "+this.color.green+", "+this.color.blue+", "+this.color.alpha+")";t.fillText(this.text,0,0,Vectr.WIDTH)}else{t.strokeStyle="rgba("+this.color.red+", "+this.color.green+", "+this.color.blue+", "+this.color.alpha+")";t.strokeText(this.text,0,0,Vectr.WIDTH)}t.restore()};Vectr.Label.prototype.update=function(t){return};Vectr.Label.prototype.width=function(t){var e;t.save();t.font=this.font.size+" "+this.font.family;t.textAlign=this.alignment;e=t.measureText(this.text);t.restore();return e.width}})(window);(function(t){if(typeof t.Vectr==="undefined"){t.Vectr={}}Vectr.Layer=function(){this.children=[]};Vectr.Layer.prototype.draw=function(t){if(typeof this.clearColor==="string"){t.save();t.fillStyle=this.clearColor;t.fillRect(0,0,t.canvas.width,t.canvas.height);t.restore()}else{t.clearRect(0,0,t.canvas.width,t.canvas.height)}var e=this.children.length;while(e--){this.children[e].draw(t)}};Vectr.Layer.prototype.update=function(t){var e=this.children.length;while(e--){this.children[e].update(t)}};Vectr.Layer.prototype.add=function(t){this.children.push(t)};Vectr.Layer.prototype.remove=function(t){var e=this.children.indexOf(t);if(e!==-1){this.children.splice(e,1)}};Vectr.Layer.prototype.destroy=function(){var t=this.children.length;while(t--){if(typeof this.children[t].destroy==="function"){this.children[t].destroy()}}}})(window);(function(t){if(typeof t.Vectr==="undefined"){t.Vectr={}}Vectr.Pool=function(){this.length=0;this.children=[];this.inactive=[]};Vectr.Pool.prototype.activate=function(){if(this.inactive.length===0){return null}var t=this.inactive.pop();t.active=true;this.children.push(t);this.length+=1;return t};Vectr.Pool.prototype.activateAll=function(){var t;while(this.inactive.length){t=this.inactive.pop();t.active=true;this.children.push(t);this.length+=1}};Vectr.Pool.prototype.deactivate=function(t){if(typeof this.children[t]==="undefined"){return}this.children[t].active=false;this.inactive.push(this.children[t]);var e,i;for(e=t,i=this.children.length-1;e<i;e+=1){this.children[e]=this.children[e+1]}this.children.length=i;this.length-=1;if(this.length===0){this.active=false}};Vectr.Pool.prototype.at=function(t){return this.children[t]||null};Vectr.Pool.prototype.add=function(t){if(typeof t==="object"&&t.active===true){this.children.push(t);this.length+=1}else{this.inactive.push(t)}};Vectr.Pool.prototype.update=function(t){var e=this.children.length;while(e--){this.children[e].update(t);if(this.children[e].active===false){this.deactivate(e)}}};Vectr.Pool.prototype.draw=function(t){var e=this.children.length;while(e--){this.children[e].draw(t)}}})(window);(function(t){if(typeof t.Vectr==="undefined"){t.Vectr={}}Vectr.Shape=function(t,e,i,s,n,o){var a;this.shape=i||"square";this.size=s||10;this.lineWidth=1;this.lineJoin="round";this.scale=1;this.speed=1;this.rotation=0;this.position={x:t,y:e};this.velocity={x:0,y:0};this.active=true;this.solid=false;this.color={red:255,green:255,blue:255,alpha:1};if(typeof n!=="undefined"){a=n.split(",");if(a.length===4){this.color.red=parseInt(a[0].replace("rgba(",""),10);this.color.green=parseInt(a[1],10);this.color.blue=parseInt(a[2],10);this.color.alpha=parseFloat(a[3].replace(")",""),10)}}this.shadow={x:0,y:0,blur:0,color:{red:255,green:255,blue:255,alpha:1}};if(typeof o!=="undefined"){a=o.split(" ");if(a.length===7){this.shadow.x=parseInt(a.shift(),10);this.shadow.y=parseInt(a.shift(),10);this.shadow.blur=parseInt(a.shift(),10);a=a.join(" ").split(",");if(a.length===4){this.shadow.color.red=parseInt(a.shift().replace("rgba(",""),10);this.shadow.color.green=parseInt(a.shift(),10);this.shadow.color.blue=parseInt(a.shift(),10);this.shadow.color.alpha=parseFloat(a.shift().replace(")",""),10)}}}};Vectr.Shape.prototype.draw=function(t){var e;if(this.active===false){return}t.save();t.translate(this.position.x,this.position.y);if(this.scale!==1){t.scale(this.scale,this.scale)}if(this.rotation!==0&&this.rotation!==360){t.rotate(this.rotation*Math.PI/180)}if(this.shadow.x>0||this.shadow.y>0||this.shadow.blur>0){t.shadowOffsetX=this.shadow.x;t.shadowOffsetY=this.shadow.y;t.shadowBlur=this.shadow.blur;t.shadowColor="rgba("+this.shadow.color.red+", "+this.shadow.color.green+", "+this.shadow.color.blue+", "+this.shadow.color.alpha+")"}t.lineWidth=this.lineWidth;t.lineJoin=this.lineJoin;if(typeof this.customPath==="function"){this.customPath(t)}else{t.beginPath();switch(this.shape){case"triangle":t.moveTo(this.size/2*Math.cos(0),this.size/2*Math.sin(0));t.lineTo(this.size/2*Math.cos(120*Math.PI/180),this.size/2*Math.sin(120*Math.PI/180));t.lineTo(this.size/2*Math.cos(240*Math.PI/180),this.size/2*Math.sin(240*Math.PI/180));t.lineTo(this.size/2*Math.cos(0),this.size/2*Math.sin(0));break;case"circle":t.arc(0,0,this.size/2,360,false);break;case"square":t.moveTo(this.size/2,this.size/2);t.lineTo(this.size/2,-this.size/2);t.lineTo(-this.size/2,-this.size/2);t.lineTo(-this.size/2,this.size/2);t.lineTo(this.size/2,this.size/2);break}t.closePath();if(this.solid===true){t.fillStyle="rgba("+this.color.red+", "+this.color.green+", "+this.color.blue+", "+this.color.alpha+")";t.fill()}else{t.strokeStyle="rgba("+this.color.red+", "+this.color.green+", "+this.color.blue+", "+this.color.alpha+")";t.stroke()}}t.restore()};Vectr.Shape.prototype.update=function(t){if(this.active===false){return}this.position.x+=this.velocity.x*this.speed*t;this.position.y+=this.velocity.y*this.speed*t};Vectr.Shape.prototype.collidesWith=function(t){if(this.shape==="square"){return Math.abs(this.position.x-t.position.x)<this.size/2+t.size/2&&Math.abs(this.position.y-t.position.y)<this.size/2+t.size/2}else{return Math.sqrt(Math.pow(t.position.x-this.position.x,2)+Math.pow(t.position.y-this.position.y,2))<this.size/2+t.size/2}}})(window);